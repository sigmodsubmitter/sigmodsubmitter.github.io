<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link href="images/favicon-monkey.png" rel="icon" type="image/x-icon"/>

    <title>LSM Tuning with Monkey</title>
   

    <!-- Bootstrap Core CSS - Uses Bootswatch Flatly Theme: http://bootswatch.com/flatly/ -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/main.css" rel="stylesheet">
    <link href="css/lsm_button.css" rel="stylesheet">
    <link href="css/tooltip.css" rel="stylesheet">


    <!-- Custom JS -->
    <script src="js/monkey.js"></script>
    <script src="js/autoRerun.js"></script>

    <!-- Custom Fonts -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Permanent+Marker%7CReenie+Beanie%7CRock+Salt%7CIndie+Flower' rel='stylesheet' type='text/css'>    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<script type="text/javascript" src="js/loader.js"></script>
    <script type="text/javascript">
      // google.charts.load('current', {'packages':['corechart']});
      // google.charts.setOnLoadCallback(drawChart);
    </script>
</head>

<body id="page-top" class="index">

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#page-top">Monkey</em></a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="#page-top"></a>
                    </li>
                    <li class="page-scroll">
                        <a href="#problem">The Problem</a>
                    </li>
                    <li class="page-scroll">
                        <a href="#research">Research</a>
                    </li>
                    <li class="page-scroll">
                        <a href="#demo">Visualization</a>
                    </li>

<!--
                      <li class="page-scroll">
                        <a href="#overview">Overview</a>
                    </li>
                   <li class="page-scroll">
                        <a href="#research">Research</a>
                    </li>
 
                     <li class="page-scroll">
                        <a href="#people">People</a>
                    </li>
                     <li class="page-scroll">
                        <a href="#publications">Papers</a>
                    </li>
                    <li class="page-scroll">
                        <a href="#about">About</a>
                    </li>
  --> 
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="intro-text">
                        <span class="name"><u>M</u>onkey: <u>O</u>ptimal <u>N</u>avigable <u>Key</u>-Value Store</span>
                     </div>
                </div>
            </div>

        </div>
    </header>


    <section id="problem">
        <div class="container">
            <div class="row" style="text-align: center">
            	<h2>Problem: Suboptimal LSM-Tree Tuning</h2>
                <br>
            </div>
            <div class="row">
                <div class="col-lg-4">
                    <img class="img-responsive img-centered" src="./images/key-value.png" alt="">
                </div>
                <div class="col-lg-8">
                    <p>The backbone of modern, persistent key-value stores is an LSM-tree. Modern applications require both efficient lookups and updates, and LSM-trees provide a good balance by buffering updates in main memory, flushing the buffer to persistent storage as a sorted run when it is full, and bounding lookup cost by (1) sort-merging runs in the background and (2) using main memory-resident Bloom filters to probabilistically skip runs that do not contain a target key.  </p>
                    <p>
                    In this work, we show that LSM-based key-value stores exhibit an intrinsic, trade-off between lookup cost, update cost, and main memory utilization. However, all existing designs enable a suboptimal and difficult to tune trade-off among these metrics. We pinpoint the problem to the fact that all modern key-value stores suboptimally co-tune the <strong>merge policy</strong>, the <strong>size ratio</strong> between levels, the <strong>buffer size</strong>, and the Bloom filters' <strong> false positive rates</strong>.
                    </p>
                </div>  
            </div>                 
                         
        </div>
    </section>


    <section id="research" class="alternate" >
        <div class="container">
            <div class="row" style="text-align: center">
                <h2>LSM-Tree Tuning With Monkey</h2>
                <br>
            </div>
            <div class="row">
                <div class="col-lg-6">
                    <p>
                        We present Monkey, an LSM-based key-value store that is able to strike the best possible balance between the costs of updates and lookups for any given application. The core insight is that worst-case lookup cost is proportional to the sum of the false positive rates of the Bloom filters across all levels of the LSM-tree. Contrary to state-of-the-art key-value stores that assign a fixed number of bits-per-element to all Bloom filters, Monkey allocates memory to filters across different levels so as to minimize the sum of their false positive rates. Thus, Monkey improves the worst-case lookup cost relative to the state-of-the-art by 50-90% without losing anything. 

                    </p>
                </div>  
                <div class="col-lg-6">
                    <img class="img-responsive img-centered" src="./images/monkey-working.png" alt="">
                </div>
            </div>    
            <div class="row">
                <div class="col-lg-12">
                <p>
                Furthermore, we map the LSM-tree design space onto a closed-form model that precisely predicts the worst-case I/O costs of lookups and updates with respect to any tuning and dataset. The model enables finding the balance between lookup and update costs that maximizes throughput for a given application workload. The model can also answer what-if questions about how changes in environmental parameters would impact performance and how to adapt the various LSM-tree design elements accordingly. 

                <!--
                depending on the workload (proportion of lookups and updates), the dataset (number and size of entries), and the underlying hardware (main memory available, disk vs. flash)

                answer what-if design questions about how changes in environmental parameters would impact performance and how to adapt the various LSM-tree design elements accordingly. --></p>
                </div>
            </div>
        </div>
    </section>
    <!-- Overview -->
    <!-- <section id="overview"> -->


    <section id="demo" style="padding-bottom: 0px">
        <div class="container page-scroll">


            <div class="row" style="text-align: center">
                <h2>Monkey in Action</h2>
                <br>
            </div>
            <div class="row">
                <div class="col-lg-12">
                <p> 
                We now present an interactive visualization of the Monkey design space and how to navigate it. It is meant as an educational tool to demonstrate the impact of different design decisions on performance, and as a tuning tool to help system administrators improve performance and answer what-if design questions. 
                </p>
                <p>
                <strong>Figure 1: Parameterized Trade-off Curve.</strong>   
                In Figure 1 below, we plot the trade-off curves between the worst-case costs of lookups and updates for both Monkey and the state-of-the-art.
                To focus on a particular slice of the design space, we enable parameterization of the <em>dataset </em> (number and size of data entries), the <em>environment</em> (size of persistent storage pages), and <em>main memory allocation</em> (size of the LSM-tree's buffer, and total size of all Bloom filters). We enable navigating these curves to strike a particular balance between lookup cost and update cost by varying the <em> merge operation frequency, </em> which is a function of the merge policy (tiering vs. leveling) and the size ratio between adjacent levels of the LSM-tree. 
                </p> 

            
                <p>
                <strong>Figure 2: LSM-tree Visualization.</strong> In Figure 2 below, we illustrate the structure of the LSM-tree resulting from any particular configuration. This visualisation enables a more detailed comparison  how Monkey and state-of-the-art designs tune the Bloom filters for every level of a particular LSM-tree. 
                </p>
         <p>
                 <strong>Default Configurations.</strong> We give three default configurations as reference points. All of them are for a 1 TB LSM-tree with 16 byte entries. Configurations 1 and 2 reflect the default tuning of two state-of-the-art systems, LevelDB and Cassandra respectively. Configuration 3 is an edge-case where no memory is allocated to the Bloom filters, and so the trade-off curves for Monkey and state-of-the-art designs converge.
                </p>

                </div>
            </div>

        </div>
    </section>

    <section id="interactiveDemo" style="padding: 30px">
        <div class="container page-scroll">

            <!-- <a href="#interactiveDemo" id="interactiveDemo"></a>  -->

            <!-- <div id="interactiveDemo" class="row" style="">  -->
            <!-- </div>  -->

            <div class="row" style="text-align: center">
                <h2>Interactive Visualization</h2>
                <p style="text-align: center;">
                <em>Click on one of the configuration buttons below or enter a custom configuration to visualize the corresponding performance trade-off curves in Figure 1 and the resulting LSM-tree tuning in Figure 2.  </em>
                </p>
                <br>
            </div>


            <div class="row">
                <div class="col-lg-4">
                    <div class="input-group input-group-lg text-center">
                        <span class="input-group-btn">
                            <a id="scenario1" class="btn btn-default btn-params" type="button" id="bloomTuningButton" onclick="scenario1()" href="#interactiveDemo">Configuration 1</a>
                        </span>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="input-group input-group-lg text-center">
                        <span class="input-group-btn">
                            <a id="scenario2" class="btn btn-default btn-params" type="button" id="bloomTuningButton" onclick="scenario2()" href="#interactiveDemo">Configuration 2</a>
                        </span>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="input-group input-group-lg text-center">
                        <span class="input-group-btn">
                            <a id="scenario3" class="btn btn-default btn-params" type="button" id="bloomTuningButton" onclick="scenario3()" href="#interactiveDemo">Configuration 3</a>
                        </span>
                    </div>
                </div>
            </div>         
            <br>
            <div class="row">
                <div class="col-lg-6">    
                <h4 style="text-align: center">Dataset</h4>            
                    
                </div>
                <div class="col-lg-6">                
                    <h4 style="text-align: center">Environment</h4>
                </div>                
                <div class="col-lg-6">
                    <div class="input-group">
                      <span class="input-group-addon"><span data-tooltip="Number of Entries in the Index (e.g., 10485760)." data-tooltip-position="bottom">1. # Entries</span></span>
                      <input id="N" type="text" class="form-control" aria-label="Index Size N (elements)" placeholder="Number of Entries in the Index (e.g., 10485760)" style="text-align:right" onkeyup="re_run()"/>
                    </div>
                    <br>
                    <div class="input-group">
                      <span class="input-group-addon"><span data-tooltip="Key-Value pair size in bytes (e.g., 16)." data-tooltip-position="bottom">2. Entry size (bytes)</span></span>
                      <input id="E" type="text" class="form-control" aria-label="Key-Value pair size (bytes)" placeholder="Key-Value pair size in bytes (e.g., 16)" style="text-align:right" onkeyup="re_run()"/>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="input-group">
                      <span class="input-group-addon"><span data-tooltip="Page Size in bytes (e.g., 4096)." data-tooltip-position="bottom">3. Page size (bytes)</span></span>
                      <input id="P" type="text" class="form-control" aria-label="Page Size P (bytes)" placeholder="Page Size in bytes (e.g., 4096)" style="text-align:right" onkeyup="re_run()"/>
                    </div>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-lg-6">    
                <h4 style="text-align: center">Main Memory Allocation</h4>            
                    
                </div>
                <div class="col-lg-6">                
                    <h4 style="text-align: center">Merge Operation Frequency</h4>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-6">                
                    <div class="input-group">
                      <span class="input-group-addon"><span data-tooltip="Buffer Size in MB (e.g., 2)." data-tooltip-position="bottom">4. Buffer size (MB)</span></span>
                      <input id="mbuffer" type="text" class="form-control" aria-label="Buffer Size Mbuffer (MB)" placeholder="Buffer Size in MB (e.g., 2)"  style="text-align:right" onkeyup="re_run()"/>
                    </div>
                </div>
                <div class="col-lg-6">                
                    <div class="input-group">
                    <span class="input-group-addon" style="text-align: left;"><span data-tooltip="With leveling each level has one run, and with tiering each level has (up to) size_ratio-1 runs." data-tooltip-position="bottom" >6. Merge policy</span></span>
                      <span class="input-group-addon">leveling&nbsp;<input id="leveltier" name="ltradio" type="radio" aria-label="level" value="1" checked="true" onchange="re_run()"/></span>
                      <span class="input-group-addon">tiering&nbsp;<input id="leveltier" name="ltradio" type="radio" aria-label="tier" value="0" onchange="re_run()"/></span>
                    </div>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-lg-6"> 


                    <div class="input-group">
                    <span class="input-group-addon"><span data-tooltip="Total main memory allocated to BFs in MB (e.g., 6)." data-tooltip-position="bottom">5. Bloom filters' overall size (MB)</span></span>
                      <input id="mfilter" type="text" class="form-control" aria-label="Bloom filter size" placeholder="Total main memory allocated to BFs in MB (e.g., 6)" style="text-align:right" onkeyup="re_run()"/>
                    </div>

                </div>
                <div class="col-lg-6">                
                    <div class="input-group">
                      <span class="input-group-addon"><span data-tooltip="Ratio between capacities of adjacent levels (e.g., 2)." data-tooltip-position="bottom">7. Size ratio</span></span>
                      <input id="T" type="text" class="form-control" aria-label="Size Ratio T" placeholder="Ratio between capacities of adjacent levels (e.g., 2)" style="text-align:right" onkeyup="re_run()"/>
                      <!-- <span class="input-group-addon">(bytes)</span> -->
                    </div>
                </div>
            </div>
            <hr>
             <div class="row text-center">

                <div id="myDiv" class="col-lg-12" style="width: 1000px; height: 400px; padding-left: 80px;"><!-- Plotly chart will be drawn inside this DIV --></div> 

            </div>
            

            <div class="row">
                <div class="col-lg-1"> </div>
                <div class="col-lg-9">
                <div class="text-container" >
                    <span id="figure1_caption" class="text-content short-text">
                     <strong>Figure 1.</strong> The LSM-tree design space exhibits a trade-off between lookup cost and update cost that can be navigated by tuning the merge policy and size ratio.                     
                    </span>
                    <span class="show-more" >
                     <a href="#" id="caption1">Show more...</a>
                    </span>
                </div>
                </div>
            </div>
            <hr>

            <div id="result_tuning" class="text-center">
                <span data-tooltip="Bloom filter allocation will be displayed here!" data-tooltip-position="bottom"><p><em>Click on one of the scenarios above and get ready for Monkey business.</em></p>  </span>
            </div>
            
            <div class="row">
                <div class="col-lg-1"> </div>
                <div class="col-lg-9">
                <div class="text-container" >
                    <span id="figure2_caption" class="text-content short-text">
                     <strong>Figure 2.</strong> Monkey minimizes lookup cost by allocating memory to Bloom filters across different levels so as to minimize the sum of their false positive rates. 
                    </span>
                    <span class="show-more" >
                     <a href="#" id="caption2">Show more...</a>
                    </span>
                </div>
                </div>
            </div>


        </div>
    </section>


    <section id="conclusions" class="alternate" >
        <div class="container">
            <div class="row" style="text-align: center">
                <div class="col-lg-8">
                    <h2>Conclusions</h2>
                </div>
                <br><br><br>
            </div>
            <div class="row">
                <div class="col-lg-8">
                    <p>
                        We show that LSM-based key-value stores exhibit an intrinsic trade-off among query cost, update cost, and main memory utilization. However, all existing designs strike a suboptimal and difficult to tune balance among these metrics. We present Monkey, an LSM-based key-value store that reaches the Pareto performance curve by allocating the Bloom filters so as to minimize the worst-case query cost. Monkey uses closed-form models to navigate the design space to find the holistic tuning that maximizes throughput under a given main memory budget, application workload, and storage medium.
                    </p>
                </div>  
                <div class="col-lg-4">
                    <img class="img-responsive img-centered" src="./images/monkey-baloon.png" alt="">
                </div>
            </div>    
        </div>
    </section>

    <!-- People Section -->
 <!--    <section  id="people">

    </section> -->

    <!-- Footer -->
    <footer class="text-center">
        <div class="footer-above">
            <div class="container">
                <div class="row">
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-below">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        Copyright &copy; SIGMOD subsmitter 2016  – All Rights Reserved
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scroll to Top Button (Only visible on small and extra-small screen sizes) -->
    <div class="scroll-top page-scroll visible-xs visble-sm">
        <a class="btn btn-primary" href="#page-top">
            <i class="fa fa-chevron-up"></i>
        </a>
    </div>

    
<script type="text/javascript">
var sc_project=11168654; 
var sc_invisible=1; 
var sc_security="99bf8838"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="shopify
analytics ecommerce tracking"
href="http://statcounter.com/shopify/" target="_blank"><img
class="statcounter"
src="//c.statcounter.com/11168654/0/99bf8838/1/"
alt="shopify analytics ecommerce
tracking"></a></div></noscript>



    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
    <script src="js/classie.js"></script>
    <script src="js/cbpAnimatedHeader.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="js/jqBootstrapValidation.js"></script>
    <!-- <script src="js/contact_me.js"></script> -->

    <!-- Custom Theme JavaScript -->
    <script src="js/main.js"></script>
    <script src="js/show_more.js"></script>
    <script src="js/drawChart.js"></script>

</body>

</html>
